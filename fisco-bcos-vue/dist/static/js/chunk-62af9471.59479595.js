(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62af9471"],{"2ac3":function(e,t,r){},"736e":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"rolesControl"},[r("el-card",[r("el-table",{staticClass:"mtop30",staticStyle:{width:"100%"},attrs:{data:e.rolesTab,stripe:"",border:""}},[r("el-table-column",{attrs:{prop:"idbankBusinessId",label:"交易ID"}}),r("el-table-column",{attrs:{prop:"businessId",label:"企业ID"}}),r("el-table-column",{attrs:{prop:"score",label:"积分(正为申请，负为承兑)"}}),r("el-table-column",{attrs:{prop:"accept",label:"状态",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:e._f("tagClass")(t.row.accept)}},[e._v(e._s(e._f("statusText")(t.row.accept)))])]}}])}),r("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"success",disabled:0!==t.row.accept},on:{click:function(r){return e.toSuccess(t.row)}}},[e._v("Accept")])]}}])})],1)],1),r("el-dialog",{staticClass:"diaForm",attrs:{title:"操作编辑",visible:e.diaIsShow},on:{"update:visible":function(t){e.diaIsShow=t}}},[r("el-form",{ref:"rolesForm",attrs:{model:e.formData,rules:e.rules,"label-width":"140px"}},[r("el-form-item",{attrs:{label:"银行ID",prop:"key"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入要操作的银行ID"},model:{value:e.formData.key,callback:function(t){e.$set(e.formData,"key",t)},expression:"formData.key"}})],1),r("el-form-item",{attrs:{label:"积分",prop:"score"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入操作积分数"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),r("el-form-item",{attrs:{label:"操作"}},[r("el-tree",{ref:"tree",attrs:{data:e.treeData,"node-key":"name",props:e.defaultProps,"show-checkbox":"","check-strictly":!1}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.changeRoles("rolesForm",e.editType)}}},[e._v("确认")]),r("el-button",{on:{click:function(t){e.diaIsShow=!1}}},[e._v("取消")])],1)],1)],1)],1)},a=[],s=(r("5ab2"),r("e10e"),r("6d57"),r("309f"),r("0b53"),r("06a2"),r("ec25"),r("2b45"),r("cc57"),r("ed63"),r("8cf2"),r("70ea")),o=(r("4360"),r("5d51"));r("a18c");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw s}}}}function u(e,t){if(e){if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d={data:function(){return{rolesTab:[],diaIsShow:!1,formData:{},editType:"update",rules:{key:[{required:!0,message:"请输入要操作的银行ID",trigger:"blur"}],description:[{required:!0,message:"请输入要操作的积分数目",trigger:"blur"}]},editIndex:0,allRoute:["申请","承兑"],treeData:[],defaultProps:{label:"label",children:"children"}}},created:function(){this._getAllRolse(),this.treeData=this.getTreeData(this.allRoute)},filters:{statusText:function(e){if(void 0!==e)return 1===e?"已完成":0===e?"待审核":2===e?"配送中":"已取消"},tagClass:function(e){if(void 0!==e)return 1===e?"success":0===e?"info":2===e?"warning":"danger"}},methods:{_getAllRolse:function(){var e=this;Object(o["d"])().then((function(t){e.rolesTab=t.response,console.log(t.response)})).catch((function(t){e.$message.error(t)}))},isAdmin:function(e){return"admin"===e.key||"user"===e.key},deleteRoles:function(e){var t=this;this.$confirm("此操作将永久删除相关数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.rolesTab.splice(e,1),t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},addRolesTab:function(){var e=this;this.diaIsShow=!0,this.editType="add",this.formData={},this.$nextTick((function(){e.$refs.rolesForm.clearValidate(),e.$refs.tree.setCheckedKeys([])}))},editRoles:function(e,t){var r=this;this.diaIsShow=!0,this.editIndex=e,this.editType="update",this.formData=Object.assign({},this.formData,{key:t.key,description:t.description}),this.$nextTick((function(){r.$refs.rolesForm.clearValidate(),r.$refs.tree.setCheckedKeys(t.pages)}))},toSuccess:function(e){var t=this;e.accept=1;var r={businessId:e.businessId,score:e.score,idbankBusinessId:e.idbankBusinessId};Object(o["b"])(r).then((function(e){t.$notify({title:"成功",message:"处理成功",type:"success"}),console.log(e)})).catch((function(e){}))},changeRoles:function(e,t){var r=this;this.$refs[e].validate((function(e){if(e){var n=r.$refs.tree.getCheckedKeys();if("update"===t){var a=r.editIndex;r.rolesTab[a].key=r.formData.key,r.rolesTab[a].description=r.formData.description,r.rolesTab[a].pages=n,r.$notify({title:"成功",message:"权限修改成功",type:"success"})}else if("add"===t){var s={};s.idbankBusinessId=r.rolesTab.length+14,s.score=r.formData.description,s.accept=0,s.businessId=parseInt(localStorage.getItem("name")),s.pages=n,"承兑"===s.pages[0]&&(s.score=0-s.score);var o={score:s.score};r.rolesTab.push(s),getPoints(o).then((function(e){r.$notify({title:"成功",message:"处理成功",type:"success"})})).catch((function(e){}))}r.diaIsShow=!1}}))},getTreeData:function(e){var t,r=[],n=l(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,s={label:a,name:a};a.children&&(s.children=this.getTreeData(a.children)),r.push(s)}}catch(o){n.e(o)}finally{n.f()}return r},hasOnlyChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=e.filter((function(e){return!e.hidden}));return 1!==r.length||t.meta?0===r.length&&t:r[0]},forSearchArr:function(e,t){var r,n=[],a=l(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,o=c({},s);t.includes(o.name)&&(o.children&&(o.children=this.forSearchArr(o.children,t)),n.push(o))}}catch(i){a.e(i)}finally{a.f()}return n}}},p=d,h=(r("751d"),r("9160"),r("4023")),b=Object(h["a"])(p,n,a,!1,null,"d6a44eb4",null);t["default"]=b.exports},"751d":function(e,t,r){"use strict";var n=r("2ac3"),a=r.n(n);a.a},"853d":function(e,t,r){},9160:function(e,t,r){"use strict";var n=r("853d"),a=r.n(n);a.a}}]);